<Page x:Class="SpaceInvaders.Wpf.Views.GamePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Game" Background="#121212"
      KeyDown="OnKeyDown" KeyUp="OnKeyUp" Loaded="OnLoaded">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="True" Margin="0,0,0,8">
            <Button Content="← Menu" Width="120" Height="40" Click="OnMenu" />

            <!-- Wave box -->
            <Border Width="56" Height="56" Margin="12,0,0,0" BorderBrush="#3A3A3A" BorderThickness="2" CornerRadius="6" Background="#0B0B0B">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="WAVE" Foreground="#AAAAAA" FontSize="10" HorizontalAlignment="Center" />
                    <TextBlock x:Name="WaveBoxText" Text="1" Foreground="#FFFFFF" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" />
                </StackPanel>
            </Border>

            <TextBlock x:Name="HudText" Foreground="#E6E6E6" FontSize="18" Margin="12,4,0,0" />
            <TextBlock x:Name="StatusText" Foreground="#9AD0FF" FontSize="13" Margin="12,6,0,0" />
        </DockPanel>

        <Border Grid.Row="1" BorderBrush="#2A2A2A" BorderThickness="2" CornerRadius="6" Background="#0B0B0B">
            <Grid>
                <Canvas x:Name="GameCanvas" SnapsToDevicePixels="True"
                        HorizontalAlignment="Center" VerticalAlignment="Center" />

                <!-- Exit overlay (replaces MessageBox) -->
                <Border x:Name="ExitRunOverlay" Background="#CC000000" Visibility="Collapsed">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Width="560">
                        <TextBlock Text="Exit run?" Foreground="#FFFFFF" FontSize="26" FontWeight="SemiBold" Margin="0,0,0,8" TextAlignment="Center" />
                        <TextBlock x:Name="ExitRunText" Text="" Foreground="#D6D6D6" FontSize="14" Margin="0,0,0,16" TextAlignment="Center" />

                        <Button x:Name="CashOutBtn" Content="Cash out" Height="52" Margin="0,6" Click="OnCashOut" />
                        <Button x:Name="AbandonBtn" Content="Abandon run" Height="52" Margin="0,6" Click="OnAbandon" />
                        <Button x:Name="CancelExitBtn" Content="Cancel" Height="44" Margin="0,12,0,0" Click="OnCancelExit" />

                        <TextBlock Text="Tip: Esc closes this" Foreground="#AFAFAF" FontSize="12" Margin="0,12,0,0" TextAlignment="Center" />
                    </StackPanel>
                </Border>

                <Border x:Name="UpgradeOverlay" Background="#CC000000" Visibility="Collapsed">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Width="520">
                        <TextBlock Text="Choose an upgrade" Foreground="#FFFFFF" FontSize="22" FontWeight="SemiBold" Margin="0,0,0,12" TextAlignment="Center" />
                        <UniformGrid Columns="1" Rows="5">
                            <Button x:Name="UpgradeBtn1" Margin="0,6" Padding="12" Click="OnUpgrade1" />
                            <Button x:Name="UpgradeBtn2" Margin="0,6" Padding="12" Click="OnUpgrade2" />
                            <Button x:Name="UpgradeBtn3" Margin="0,6" Padding="12" Click="OnUpgrade3" />
                            <Button x:Name="UpgradeBtn4" Margin="0,6" Padding="12" Click="OnUpgrade4" />
                            <Button x:Name="UpgradeBtn5" Margin="0,6" Padding="12" Click="OnUpgrade5" />
                        </UniformGrid>
                        <TextBlock Text="Tip: press 1 / 2 / 3 / 4 / 5" Foreground="#CFCFCF" FontSize="12" Margin="0,12,0,0" TextAlignment="Center" />
                    </StackPanel>
                </Border>

                <Border x:Name="GameOverOverlay" Background="#CC000000" Visibility="Collapsed">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock x:Name="GameOverText" Text="Game Over" Foreground="#FFFFFF" FontSize="28" FontWeight="Bold" TextAlignment="Center" />
                        <TextBlock Text="Press R to restart" Foreground="#CFCFCF" FontSize="14" Margin="0,12,0,0" TextAlignment="Center" />
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <TextBlock Grid.Row="2" Foreground="#AAAAAA" FontSize="12" Margin="0,8,0,0"
                   Text="Controls: A/D or ←/→ move, Space shoot, P pause, Esc menu" />
    </Grid>
</Page>

